"use strict";(()=>{var e={};e.id=594,e.ids=[594],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},7568:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>f,originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>h,routeModule:()=>p,serverHooks:()=>v,staticGenerationAsyncStorage:()=>k,staticGenerationBailout:()=>m});var s={};t.r(s),t.d(s,{GET:()=>d,POST:()=>l});var i=t(5419),o=t(9108),a=t(9678),n=t(8070),u=t(8093),c=t(3205);async function d(e){try{let r=e.headers.get("authorization");if(!r||!r.startsWith("Bearer "))return n.Z.json({error:"Token de autenticaci\xf3n requerido"},{status:401});let t=r.substring(7),s=(0,c.WX)(t);if(!s)return n.Z.json({error:"Token inv\xe1lido"},{status:401});let i=await u._.ticket.findMany({where:{userId:s.userId},include:{replies:{include:{user:{select:{name:!0,avatar:!0}}},orderBy:{createdAt:"asc"}}},orderBy:{createdAt:"desc"}});return n.Z.json({tickets:i})}catch(e){return console.error("Error obteniendo tickets:",e),n.Z.json({error:"Error interno del servidor"},{status:500})}}async function l(e){try{let r=e.headers.get("authorization");if(!r||!r.startsWith("Bearer "))return n.Z.json({error:"Token de autenticaci\xf3n requerido"},{status:401});let t=r.substring(7),s=(0,c.WX)(t);if(!s)return n.Z.json({error:"Token inv\xe1lido"},{status:401});let{title:i,description:o,category:a,priority:d}=await e.json();if(!i||!o||!a)return n.Z.json({error:"T\xedtulo, descripci\xf3n y categor\xeda son requeridos"},{status:400});let l=await u._.ticket.create({data:{title:i,description:o,category:a,priority:d||"MEDIUM",userId:s.userId},include:{replies:{include:{user:{select:{name:!0,avatar:!0}}}}}});return n.Z.json({ticket:l})}catch(e){return console.error("Error creando ticket:",e),n.Z.json({error:"Error interno del servidor"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/tickets/route",pathname:"/api/tickets",filename:"route",bundlePath:"app/api/tickets/route"},resolvedPagePath:"C:\\Users\\Yessica\\Desktop\\auction-master\\app\\api\\tickets\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:k,serverHooks:v,headerHooks:f,staticGenerationBailout:m}=p,y="/api/tickets/route";function g(){return(0,a.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:k})}},3205:(e,r,t)=>{t.d(r,{WX:()=>o}),t(6521);var s=t(6082),i=t.n(s);t(8093);let o=e=>{try{return i().verify(e,process.env.JWT_SECRET)}catch{return null}}},8093:(e,r,t)=>{t.d(r,{_:()=>i});let s=require("@prisma/client"),i=globalThis.prisma??new s.PrismaClient}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,206,928],()=>t(7568));module.exports=s})();